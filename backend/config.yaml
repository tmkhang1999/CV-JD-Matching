app:
  title: "CV-JD Matcher API"
  version: "1.0.0"
  host: "0.0.0.0"
  port: 8080
  debug: false

# DB connection via env interpolation for docker-compose
database:
  host: "${POSTGRES_HOST:-localhost}"
  port: "${POSTGRES_PORT:-5432}"
  user: "${POSTGRES_USER:-postgres}"
  password: "${POSTGRES_PASSWORD}"
  database: "${POSTGRES_DB:-cv_jd_matcher}"
  url: "postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}"
  pool_size: 12           # modest bump for concurrent uploads
  max_overflow: 24        # allow brief bursts without exhausting DB

openai:
  api_key: "${OPENAI_API_KEY}"
  extraction_model: "gpt-4o-mini"
  embedding_model: "text-embedding-3-small"
  reranking_model: "gpt-4o-mini"
  temperature: 0.1
  max_completion_tokens: 1600  # trimmed to control spend

extraction:
  timeout: 120
  max_retries: 3

matching:
  weights:
    global: 0.25
    skills_tech: 0.55
    skills_language: 0.20
  default_limit: 10
  max_limit: 50

scoring_rubric:
  total_score: 100
  stage_0_hard_filters:
    experience:
      enabled: true
      min_years: jd_defined
    required_skills:
      enabled: true
      coverage_threshold: 0.7
    location_work_mode:
      enabled: true
      hard_reject_on_mismatch: true
  stage_1_symbolic_scoring:
    weight: 55
    must_have_skill_coverage:
      weight: 35
      bands:
        - { min: 0.90, score: 35 }
        - { min: 0.80, score: 28 }
        - { min: 0.70, score: 20 }
        - { min: 0.00, score: 0 }
    technical_depth:
      weight: 20
      bands:
        high: 20
        medium: 12
        low: 5
        none: 0
  stage_2_semantic_scoring:
    weight: 35
    embeddings:
      global: 0.20
      skills_tech: 0.60
      skills_language: 0.20
  stage_3_domain_bonus:
    weight: 5
    bands:
      exact_domain: 5
      related_domain: 3
      general: 1
      none: 0
  stage_4_delta_factors:
    weight: 5
    cap: 5
  final_score_thresholds:
    shortlist: 70
    strong_hire: 85
    reject: 55

storage:
  upload_dir: "data/uploads"
